(function($,window,document){"use strict";Foundation.libs.section={name:"section",version:"4.0.9",settings:{deep_linking:!1,one_up:!0,callback:function(){}},init:function(scope,method,options){return this.scope=scope||this.scope,Foundation.inherit(this,"throttle data_options"),"string"!=typeof method?(this.set_active_from_hash(),this.events(),!0):this[method].call(this,options)},events:function(){var self=this;$(this.scope).on("click.fndtn.section","[data-section] .title",function(e){var $this=$(this);$this.closest("[data-section]"),self.toggle_active.call(this,e,self)}),$(window).on("resize.fndtn.section",self.throttle(function(){self.resize.call(this)},30)).on("hashchange",function(){self.settings.toggled||(self.set_active_from_hash(),$(this).trigger("resize"))}).trigger("resize"),$(document).on("click.fndtn.section",function(e){1>$(e.target).closest(".title").length&&$('[data-section="vertical-nav"], [data-section="horizontal-nav"]').find("section, .section").removeClass("active").attr("style","")})},toggle_active:function(e){var $this=$(this),section=$this.closest("section, .section"),content=section.find(".content"),parent=section.closest("[data-section]"),self=Foundation.libs.section,settings=$.extend({},self.settings,self.data_options(parent));if(self.settings.toggled=!0,!settings.deep_linking&&content.length>0&&e.preventDefault(),section.hasClass("active"))(self.small(parent)||self.is_vertical(parent)||self.is_horizontal(parent)||self.is_accordion(parent))&&section.removeClass("active").attr("style","");else{var prev_active_section=null,title_height=self.outerHeight(section.find(".title"));(self.small(parent)||settings.one_up)&&(prev_active_section=$this.closest("[data-section]").find("section.active, .section.active"),self.small(parent)?prev_active_section.attr("style",""):prev_active_section.attr("style","visibility: hidden; padding-top: "+title_height+"px;")),self.small(parent)?section.attr("style",""):section.css("padding-top",title_height),section.addClass("active"),null!==prev_active_section&&prev_active_section.removeClass("active").attr("style","")}setTimeout(function(){self.settings.toggled=!1},300),settings.callback()},resize:function(){var sections=$("[data-section]"),self=Foundation.libs.section;sections.each(function(){var $this=$(this),active_section=$this.find("section.active, .section.active");if($.extend({},self.settings,self.data_options($this)),active_section.length>1)active_section.not(":first").removeClass("active").attr("style","");else if(1>active_section.length&&!self.is_vertical($this)&&!self.is_horizontal($this)&&!self.is_accordion($this)){var first=$this.find("section, .section").first();first.addClass("active"),self.small($this)?first.attr("style",""):first.css("padding-top",self.outerHeight(first.find(".title")))}self.small($this)?active_section.attr("style",""):active_section.css("padding-top",self.outerHeight(active_section.find(".title"))),self.position_titles($this),self.is_horizontal($this)&&!self.small($this)?self.position_content($this):self.position_content($this,!1)})},is_vertical:function(el){return/vertical\-nav/i.test(el.data("section"))},is_horizontal:function(el){return/horizontal\-nav/i.test(el.data("section"))},is_accordion:function(el){return/accordion/i.test(el.data("section"))},is_tabs:function(el){return/tabs/i.test(el.data("section"))},set_active_from_hash:function(){var hash=window.location.hash.substring(1),sections=$("[data-section]"),self=this;sections.each(function(){var section=$(this),settings=$.extend({},self.settings,self.data_options(section));hash.length>0&&settings.deep_linking&&(section.find("section, .section").attr("style","").removeClass("active"),section.find('.content[data-slug="'+hash+'"]').closest("section, .section").addClass("active"))})},position_titles:function(section,off){var titles=section.find(".title"),previous_width=0,self=this;"boolean"==typeof off?titles.attr("style",""):titles.each(function(){var $this=$(this);($this.closest(".tabs").length||!$this.closest(".accordion").length&&$this.closest(".auto").length&&EWF.$window.width()>=768)&&($this.css("left",previous_width),previous_width+=self.outerWidth($(this)))})},position_content:function(section,off){var titles=section.find(".title"),content=section.find(".content"),self=this;"boolean"==typeof off?(content.attr("style",""),section.attr("style","")):(section.find("section, .section").each(function(){var title=$(this).find(".title"),content=$(this).find(".content");content.css({left:title.position().left-1,top:self.outerHeight(title)-2})}),"function"==typeof Zepto?section.height(this.outerHeight(titles.first())):section.height(this.outerHeight(titles.first())-2))},small:function(el){var $html=($.extend({},this.settings,this.data_options(el)),$("html"));return this.is_tabs(el)?!1:el&&this.is_accordion(el)?!0:$html.hasClass("lt-ie9")?!0:$html.hasClass("ie8compat")?!0:768>$(this.scope).width()},off:function(){$(this.scope).off(".fndtn.section"),$(window).off(".fndtn.section"),$(document).off(".fndtn.section")}}})(Foundation.zj,this,this.document);