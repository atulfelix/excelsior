(function($,window,document,undefined){"use strict";Foundation.libs.forms={name:"forms",version:"4.0.4",settings:{disable_class:"no-custom"},init:function(scope,method,options){return this.scope=scope||this.scope,"object"==typeof method&&$.extend(!0,this.settings,method),"string"!=typeof method?(this.settings.init||this.events(),this.assemble(),this.settings.init):this[method].call(this,options)},assemble:function(){$('form.custom input[type="radio"]',$(this.scope)).not('[data-customforms="disabled"]').each(this.append_custom_markup),$('form.custom input[type="checkbox"]',$(this.scope)).not('[data-customforms="disabled"]').each(this.append_custom_markup),$("form.custom select",$(this.scope)).not('[data-customforms="disabled"]').each(this.append_custom_select)},events:function(){var self=this;$(this.scope).on("change.fndtn.forms",'form.custom select:not([data-customforms="disabled"])',function(){self.refresh_custom_select($(this))}).on("click.fndtn.forms","form.custom label",function(e){var $customCheckbox,$customRadio,$associatedElement=$("#"+self.escape($(this).attr("for"))+':not([data-customforms="disabled"])');0!==$associatedElement.length&&("checkbox"===$associatedElement.attr("type")?(e.preventDefault(),$customCheckbox=$(this).find("span.custom.checkbox"),0==$customCheckbox.length&&($customCheckbox=$(this).siblings("span.custom.checkbox").first()),self.toggle_checkbox($customCheckbox)):"radio"===$associatedElement.attr("type")&&(e.preventDefault(),$customRadio=$(this).find("span.custom.radio"),0==$customRadio.length&&($customRadio=$(this).siblings("span.custom.radio").first()),self.toggle_radio($customRadio)))}).on("click.fndtn.forms","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(e){var $this=$(this),$dropdown=$this.closest("div.custom.dropdown"),$select=$dropdown.prev();return $dropdown.hasClass("open")||$(self.scope).trigger("click"),e.preventDefault(),!1===$select.is(":disabled")?($dropdown.toggleClass("open"),$dropdown.hasClass("open")?$(self.scope).on("click.fndtn.forms.customdropdown",function(){$dropdown.removeClass("open"),$(self.scope).off(".fndtn.forms.customdropdown")}):$(self.scope).on(".fndtn.forms.customdropdown"),!1):undefined}).on("click.fndtn.forms touchend.fndtn.forms","form.custom div.custom.dropdown li",function(e){var $this=$(this),$customDropdown=$this.closest("div.custom.dropdown"),$select=$customDropdown.prev(),selectedIndex=0;if(e.preventDefault(),e.stopPropagation(),!$(this).hasClass("disabled")){$("div.dropdown").not($customDropdown).removeClass("open");var $oldThis=$this.closest("ul").find("li.selected");$oldThis.removeClass("selected"),$this.addClass("selected"),$customDropdown.removeClass("open").find("a.current").html($this.html()),$this.closest("ul").find("li").each(function(index){$this[0]==this&&(selectedIndex=index)}),$select[0].selectedIndex=selectedIndex,$select.data("prevalue",$oldThis.html()),$select.trigger("change")}}),this.settings.init=!0},append_custom_markup:function(idx,sel){var $this=$(sel).hide(),type=$this.attr("type"),$span=$this.next("span.custom."+type);0===$span.length&&($span=$('<span class="custom '+type+'"></span>').insertAfter($this)),$span.toggleClass("checked",$this.is(":checked")),$span.toggleClass("disabled",$this.is(":disabled"))},append_custom_select:function(idx,sel){var $listItems,self=Foundation.libs.forms,$this=$(sel),$customSelect=$this.next("div.custom.dropdown"),$customList=$customSelect.find("ul"),$selector=($customSelect.find(".current"),$customSelect.find(".selector")),$options=$this.find("option"),$selectedOption=$options.filter(":selected"),copyClasses=$this.attr("class")?$this.attr("class").split(" "):[],maxWidth=0,liHtml="",$currentSelect=!1;if(!$this.hasClass(self.settings.disable_class)){if(0===$customSelect.length){var customSelectSize=$this.hasClass("small")?"small":$this.hasClass("medium")?"medium":$this.hasClass("large")?"large":$this.hasClass("expand")?"expand":"";$customSelect=$('<div class="'+["custom","dropdown",customSelectSize].concat(copyClasses).filter(function(item,idx,arr){return""==item?!1:arr.indexOf(item)==idx}).join(" ")+'"><a href="#" class="selector"></a><ul /></div>'),$selector=$customSelect.find(".selector"),$customList=$customSelect.find("ul"),liHtml=$options.map(function(){return"<li>"+$(this).html()+"</li>"}).get().join(""),$customList.append(liHtml),$currentSelect=$customSelect.prepend('<a href="#" class="current">'+$selectedOption.html()+"</a>").find(".current"),$this.after($customSelect).hide()}else liHtml=$options.map(function(){return"<li>"+$(this).html()+"</li>"}).get().join(""),$customList.html("").append(liHtml);if($customSelect.toggleClass("disabled",$this.is(":disabled")),$listItems=$customList.find("li"),$options.each(function(index){this.selected&&($listItems.eq(index).addClass("selected"),$currentSelect&&$currentSelect.html($(this).html())),$(this).is(":disabled")&&$listItems.eq(index).addClass("disabled")}),!$customSelect.is(".small, .medium, .large, .expand")){$customSelect.addClass("open");var self=Foundation.libs.forms;self.hidden_fix.adjust($customList),maxWidth=self.outerWidth($listItems)>maxWidth?self.outerWidth($listItems):maxWidth,Foundation.libs.forms.hidden_fix.reset(),$customSelect.removeClass("open")}}},refresh_custom_select:function($select){var self=this,maxWidth=0,$customSelect=$select.next(),$options=$select.find("option");$customSelect.find("ul").html(""),$options.each(function(){var $li=$("<li>"+$(this).html()+"</li>");$customSelect.find("ul").append($li)}),$options.each(function(index){this.selected&&($customSelect.find("li").eq(index).addClass("selected"),$customSelect.find(".current").html($(this).html())),$(this).is(":disabled")&&$customSelect.find("li").eq(index).addClass("disabled")}),$customSelect.removeAttr("style").find("ul").removeAttr("style"),$customSelect.find("li").each(function(){$customSelect.addClass("open"),self.outerWidth($(this))>maxWidth&&(maxWidth=self.outerWidth($(this))),$customSelect.removeClass("open")})},toggle_checkbox:function($element){var $input=$element.prev(),input=$input[0];!1===$input.is(":disabled")&&(input.checked=input.checked?!1:!0,$element.toggleClass("checked"),$input.trigger("change"))},toggle_radio:function($element){var $input=$element.prev(),$form=$input.closest("form.custom"),input=$input[0];!1===$input.is(":disabled")&&($form.find('input[type="radio"][name="'+this.escape($input.attr("name"))+'"]').next().not($element).removeClass("checked"),$element.hasClass("checked")||$element.toggleClass("checked"),input.checked=$element.hasClass("checked"),$input.trigger("change"))},escape:function(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},hidden_fix:{tmp:[],hidden:null,adjust:function($child){var _self=this;_self.hidden=$child.parents().andSelf().filter(":hidden"),_self.hidden.each(function(){var $elem=$(this);_self.tmp.push($elem.attr("style")),$elem.css({visibility:"hidden",display:"block"})})},reset:function(){var _self=this;_self.hidden.each(function(i){var $elem=$(this),_tmp=_self.tmp[i];_tmp===undefined?$elem.removeAttr("style"):$elem.attr("style",_tmp)}),_self.tmp=[],_self.hidden=null}},off:function(){$(this.scope).off(".fndtn.forms")}}})(Foundation.zj,this,this.document);