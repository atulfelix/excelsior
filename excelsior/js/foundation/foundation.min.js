(function($){"use strict";Foundation.libs.alerts={name:"alerts",version:"4.0.0",settings:{speed:300,callback:function(){}},init:function(scope,method,options){return this.scope=scope||this.scope,"object"==typeof method&&$.extend(!0,this.settings,method),"string"!=typeof method?(this.settings.init||this.events(),this.settings.init):this[method].call(this,options)},events:function(){var self=this;$(this.scope).on("click.fndtn.alerts","[data-alert] a.close",function(e){e.preventDefault(),$(this).closest("[data-alert]").fadeOut(self.speed,function(){$(this).remove(),self.settings.callback()})}),this.settings.init=!0},off:function(){$(this.scope).off(".fndtn.alerts")}}})(Foundation.zj,this,this.document),function($,window,document,undefined){"use strict";Foundation.libs.clearing={name:"clearing",version:"4.0.0",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><img src="//:0"><p class="clearing-caption"></p><a href="#" class="clearing-main-left"><span></span></a><a href="#" class="clearing-main-right"><span></span></a></div>'},close_selectors:".clearing-close",init:!1,locked:!1},init:function(scope,method,options){return this.scope=this.scope||scope,Foundation.inherit(this,"set_data get_data remove_data throttle"),"object"==typeof method&&(options=$.extend(!0,this.settings,method)),"string"!=typeof method?($(this.scope).find("ul[data-clearing]").each(function(){var self=Foundation.libs.clearing,$el=$(this),options=options||{},settings=self.get_data($el);settings||(options.$parent=$el.parent(),self.set_data($el,$.extend(!0,self.settings,options)),self.assemble($el.find("li")),self.settings.init||self.events().swipe_events())}),this.settings.init):this[method].call(this,options)},events:function(){var self=this;return $(this.scope).on("click.fndtn.clearing","ul[data-clearing] li",function(e,current,target){var current=current||$(this),target=target||current,settings=self.get_data(current.parent());e.preventDefault(),settings||self.init(),self.open($(e.target),current,target),self.update_paddles(target)}).on("click.fndtn.clearing",".clearing-main-right",function(e){this.nav(e,"next")}.bind(this)).on("click.fndtn.clearing",".clearing-main-left",function(e){this.nav(e,"prev")}.bind(this)).on("click.fndtn.clearing",this.settings.close_selectors,function(e){Foundation.libs.clearing.close(e,this)}).on("keydown.fndtn.clearing",function(e){this.keydown(e)}.bind(this)),$(window).on("resize.fndtn.clearing",function(){this.resize()}.bind(this)),this.settings.init=!0,this},swipe_events:function(){var self=this;$(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(e){e.touches||(e=e.originalEvent);var data={start_page_x:e.touches[0].pageX,start_page_y:e.touches[0].pageY,start_time:(new Date).getTime(),delta_x:0,is_scrolling:undefined};$(this).data("swipe-transition",data),e.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(e){if(e.touches||(e=e.originalEvent),!(e.touches.length>1||e.scale&&1!==e.scale)){var data=$(this).data("swipe-transition");if(data===undefined&&(data={}),data.delta_x=e.touches[0].pageX-data.start_page_x,data.is_scrolling===undefined&&(data.is_scrolling=!!(data.is_scrolling||Math.abs(data.delta_x)<Math.abs(e.touches[0].pageY-data.start_page_y))),!data.is_scrolling&&!data.active){e.preventDefault();var direction=0>data.delta_x?"next":"prev";data.active=!0,self.nav(e,direction)}}}).on("touchend.fndtn.clearing",".visible-img",function(e){$(this).data("swipe-transition",{}),e.stopPropagation()})},assemble:function($li){var $el=$li.parent(),settings=this.get_data($el),grid=$el.detach(),data={grid:'<div class="carousel">'+this.outerHTML(grid[0])+"</div>",viewing:settings.templates.viewing},wrapper='<div class="clearing-assembled"><div>'+data.viewing+data.grid+"</div></div>";return settings.$parent.append(wrapper)},open:function($image,current,target){var root=target.closest(".clearing-assembled"),container=root.find("div").first(),visible_image=container.find(".visible-img"),image=visible_image.find("img").not($image);this.locked()||(image.attr("src",this.load($image)),this.loaded(image,function(){root.addClass("clearing-blackout"),container.addClass("clearing-container"),visible_image.show(),this.fix_height(target).caption(visible_image.find(".clearing-caption"),$image).center(image).shift(current,target,function(){target.siblings().removeClass("visible"),target.addClass("visible")})}.bind(this)))},close:function(e,el){e.preventDefault();var container,visible_image,root=function(target){return/blackout/.test(target.selector)?target:target.closest(".clearing-blackout")}($(el));return el===e.target&&root&&(container=root.find("div").first(),visible_image=container.find(".visible-img"),this.settings.prev_index=0,root.find("ul[data-clearing]").attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout"),container.removeClass("clearing-container"),visible_image.hide()),!1},keydown:function(e){var clearing=$(".clearing-blackout").find("ul[data-clearing]");39===e.which&&this.go(clearing,"next"),37===e.which&&this.go(clearing,"prev"),27===e.which&&$("a.clearing-close").trigger("click")},nav:function(e,direction){var clearing=$(".clearing-blackout").find("ul[data-clearing]");e.preventDefault(),this.go(clearing,direction)},resize:function(){var image=$(".clearing-blackout .visible-img").find("img");image.length&&this.center(image)},fix_height:function(target){var lis=target.parent().children(),self=this;return lis.each(function(){var li=$(this),image=li.find("img");li.height()>self.outerHeight(image)&&li.addClass("fix-height")}).closest("ul").width(100*lis.length+"%"),this},update_paddles:function(target){var visible_image=target.closest(".carousel").siblings(".visible-img");target.next().length?visible_image.find(".clearing-main-right").removeClass("disabled"):visible_image.find(".clearing-main-right").addClass("disabled"),target.prev().length?visible_image.find(".clearing-main-left").removeClass("disabled"):visible_image.find(".clearing-main-left").addClass("disabled")},center:function(target){return target.css({marginLeft:-(this.outerWidth(target)/2),marginTop:-(this.outerHeight(target)/2)}),this},load:function($image){var href=$image.parent().attr("href");return this.preload($image),href?href:$image.attr("src")},preload:function($image){this.img($image.closest("li").next()).img($image.closest("li").prev())},loaded:function(image,callback){function loaded(){callback()}function bindLoad(){if(this.one("load",loaded),/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var src=this.attr("src"),param=src.match(/\?/)?"&":"?";param+="random="+(new Date).getTime(),this.attr("src",src+param)}}return image.attr("src")?(this.complete||4===this.readyState?loaded():bindLoad.call(image),undefined):(loaded(),undefined)},img:function(img){if(img.length){var new_img=new Image,new_a=img.find("a");new_img.src=new_a.length?new_a.attr("href"):img.find("img").attr("src")}return this},caption:function(container,$image){var caption=$image.data("caption");return caption?container.text(caption).show():container.text("").hide(),this},go:function($ul,direction){var current=$ul.find(".visible"),target=current[direction]();target.length&&target.find("img").trigger("click",[current,target])},shift:function(current,target,callback){var skip_shift,clearing=target.parent(),old_index=this.settings.prev_index||target.index(),direction=this.direction(clearing,current,target),left=parseInt(clearing.css("left"),10),width=this.outerWidth(target);target.index()===old_index||/skip/.test(direction)?/skip/.test(direction)&&(skip_shift=target.index()-this.settings.up_count,this.lock(),skip_shift>0?clearing.animate({left:-(skip_shift*width)},300,this.unlock()):clearing.animate({left:0},300,this.unlock())):/left/.test(direction)?(this.lock(),clearing.animate({left:left+width},300,this.unlock())):/right/.test(direction)&&(this.lock(),clearing.animate({left:left-width},300,this.unlock())),callback()},direction:function($el,current,target){var response,lis=$el.find("li"),li_width=this.outerWidth(lis)+this.outerWidth(lis)/4,up_count=Math.floor(this.outerWidth($(".clearing-container"))/li_width)-1,target_index=lis.index(target);return this.settings.up_count=up_count,response=this.adjacent(this.settings.prev_index,target_index)?target_index>up_count&&target_index>this.settings.prev_index?"right":target_index>up_count-1&&this.settings.prev_index>=target_index?"left":!1:"skip",this.settings.prev_index=target_index,response},adjacent:function(current_index,target_index){for(var i=target_index+1;i>=target_index-1;i--)if(i===current_index)return!0;return!1},lock:function(){this.settings.locked=!0},unlock:function(){this.settings.locked=!1},locked:function(){return this.settings.locked},outerHTML:function(el){return el.outerHTML||(new XMLSerializer).serializeToString(el)},off:function(){$(this.scope).off(".fndtn.clearing"),$(window).off(".fndtn.clearing"),this.remove_data(),this.settings.init=!1}}}(Foundation.zj,this,this.document);