/*! Excelsior Web Framework v0.1.2 | (c) 2013 NYS ITS | https://github.com/nys-its/excelsior.git | MIT: https://github.com/nys-its/excelsior/blob/master/license.md */
(function(){$.widget("EWF.responsiveTable",{options:{dropdownLabel:"Select Columns"},_create:function(){function isDisplaying($elem){return/inline|table\-cell/.test($elem.css("display"))}function getTotalMinWidth(){var total=0;return $hdrCols.each(function(){var $th=$(this);isDisplaying($th)&&(total+=$th.data("min-width"))}),total}function setTableId(){var id="table"+(""+(new Date).getTime()).substr(9,4);return $table.attr("id",id),id}function hideCols(){var selectors=[".rt-p2",".rt-p1"];$.each(selectors,function(j,selector){return $table.width()>=totalMinWidth&&EWF.$body.width()>=$table.width()?!1:($hdrColsReversed.each(function(){var $this=$(this),$input=$('input[value="'+$this.attr("id")+'"]');return $input&&$input.data("user-changed")?!0:!$input.data("user-changed")&&isDisplaying($this)&&$this.is(selector)&&($("#"+$this.attr("id")+', [data-headers="'+$this.attr("id")+'"]').hide(),$input&&$input.prop("checked",!1),totalMinWidth=getTotalMinWidth(),$table.width()>=totalMinWidth)?!1:void 0}),void 0)})}function showCols(){var selectors=[".rt-p1",".rt-p2"],allowedWidth=$table.parent().width();$.each(selectors,function(j,selector){return totalMinWidth>=$table.width()?!1:($hdrColsReversed.each(function(){var $this=$(this),$input=$('input[value="'+$this.attr("id")+'"]');return $input&&$input.data("user-changed")?!0:!isDisplaying($this)&&$this.is(selector)&&(allowedWidth>=totalMinWidth+$this.data("min-width")&&($("#"+$this.attr("id")+', [data-headers="'+$this.attr("id")+'"]').show(),$input&&$input.prop("checked",!0)),totalMinWidth=getTotalMinWidth(),totalMinWidth>=$table.width())?!1:void 0}),void 0)}),hideCols()}function createDropDown(){return $table.is(".rt-no-dropdown")?!1:($dropdown=$("#"+tableId+"-check-container"),$dropdown.length||($dropdown=$('<div class="rt-table-menu" id="'+tableId+'-check-container"></div>'),$dropdown.insertBefore($table)),$dropdown.prepend('<a href="#" data-dropdown="drop-'+tableId+'" class="small button dropdown radius">'+opts.dropdownLabel+"</a>"),$dropdown.append('<ul id="drop-'+tableId+'" class="f-dropdown rt-table-dropdown"></ul>'),void 0)}var $dropdown,$table=$(this.element),$thead=$table.find("thead"),$tbody=$table.find("tbody"),$hdrCols=$thead.find("th"),$hdrColsReversed=$thead.find("th").reverse(),$bodyRows=$tbody.find("tr"),tableId=$table.attr("id"),totalMinWidth=0,opts=self.options;return $table.is(".not-responsive")?!1:(tableId||(tableId=setTableId($table)),createDropDown(),$hdrCols.each(function(i){var classes,$th=$(this),id=$th.attr("id");if(id||(id=tableId+"-col-"+i,$th.attr("id",id)),$th.attr("data-min-width")||$th.data("min-width",$th.width()),$th.is(".rt-persist, .rt-p1, .rt-p2")||(0===i?$th.addClass("rt-p1"):$th.addClass("rt-p2")),classes=$th.attr("class"),$bodyRows.each(function(){var cell=$(this).find("th, td").eq(i);cell.attr("data-headers",id),classes&&cell.addClass(classes)}),$dropdown&&!$th.is(".rt-persist")){var $toggle=$('<li><label for="'+tableId+"-toggle-col-"+i+'">'+'<input type="checkbox" name="toggle-cols" id="'+tableId+"-toggle-col-"+i+'" value="'+id+'">'+" "+$th.text()+"</label></li>");$dropdown.find("ul").append($toggle),$toggle.find("input").prop("checked",!0).on("change",function(){var $input=$(this),val=$input.val(),cols=$("#"+val+', [data-headers="'+val+'"]');$input.data("user-changed",!0),$input.is(":checked")?cols.show():cols.hide()})}}),totalMinWidth=getTotalMinWidth(),$(window).on("orientationchange resize",function(){showCols()}),showCols(),void 0)}})})(),$(function(){$("table").responsiveTable()});